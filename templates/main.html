<!DOCTYPE HTML>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Arxiv Sanity Preserver</title>

<!-- MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
</script>

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">

<!-- Favicon -->
<link rel="shortcut icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}" />

<!-- JS -->
<script src="{{ url_for('static', filename='jquery-1.8.3.min.js') }}"></script>
<script src="{{ url_for('static', filename='d3.min.js') }}"></script>
<script src="{{ url_for('static', filename='as-common.js') }}"></script>

<!-- Google Analytics JS -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3698471-25', 'auto');
  ga('send', 'pageview');

</script>

<script>

// passed in from flask as json
var tweets = {{ tweets | tojson }};
var papers = {{ papers | tojson }};
var pid_to_users = {{ pid_to_users | tojson }};
var msg = "{{ msg }}";
var render_format = "{{ render_format }}";
var username = "{{ g.user.username }}";
var numresults = "{{ numresults }}";
var show_prompt = "{{ show_prompt }}";

var urlq = ''; // global will be read in to QueryString when load is done

// when page loads...
$(document).ready(function(){

  urlq = QueryString.q;

  // display message, if any
  if(msg !== '') { d3.select("#rtable").append('div').classed('msg', true).html(msg); }

  // add papers to #rtable
  var done = addPapers(10, false);
  if(done) { $("#loadmorebtn").hide(); }

  // set up inifinite scrolling for adding more papers
  $(window).on('scroll', function(){
    var scrollTop = $(document).scrollTop();
    var windowHeight = $(window).height();
    var bodyHeight = $(document).height() - windowHeight;
    var scrollPercentage = (scrollTop / bodyHeight);
    if(scrollPercentage > 0.9) {
      var done = addPapers(5, true);
      if(done) { $("#loadmorebtn").hide(); }
    }
  });

  // just in case scrolling is broken somehow, provide a button handler explicit
  $("#loadmorebtn").on('click', function(){
    var done = addPapers(5, true);
    if(done) { $("#loadmorebtn").hide(); }
  });

  if(papers.length === 0) { $("#loadmorebtn").hide(); }

  if(!(typeof urlq == 'undefined')) {
    d3.select("#qfield").attr('value', urlq.replace(/\+/g, " "));
  }

  var vf = QueryString.vfilter; if(typeof vf === 'undefined') { vf = 'all'; }
  var tf = QueryString.timefilter; if(typeof tf === 'undefined') { tf = 'week'; }
  var link_endpoint = '/';
  if(render_format === 'recent') { link_endpoint = ''; }
  if(render_format === 'top') { link_endpoint = 'top'; }
  if(render_format === 'recommend') { link_endpoint = 'recommend'; }
  if(render_format === 'friends') { link_endpoint = 'friends'; }
  if(render_format === 'toptwtr') { link_endpoint = 'toptwtr'; }
  if(render_format === 'discussions') { link_endpoint = 'discussions'; }
  if(render_format === 'topics') { link_endpoint = 'topics'; }

  var time_ranges = ['day', '3days', 'week', 'month', 'year', 'alltime'];
  var time_txt = {'day':'Last day', '3days': 'Last 3 days', 'week': 'Last week', 'month': 'Last month', 'year': 'Last year', 'alltime': 'All time'}
  var time_range = tf;

  // set up time filtering options
  if(render_format === 'recommend' || render_format === 'top' || render_format === 'recent' || render_format === 'friends' || render_format === 'topics') {
    // insert version filtering options for these views
    var elt = d3.select('#recommend-time-choice');
    var vflink = vf === 'all' ? '1' : 'all'; // toggle only showing v1 or not
    if(render_format === 'recent' || render_format === 'topics') {
      var aelt = elt.append('a').attr('href', '/'+link_endpoint+'?'+'&vfilter='+vflink); // leave out timefilter from this page
    } else {
      var aelt = elt.append('a').attr('href', '/'+link_endpoint+'?'+'timefilter='+time_range+'&vfilter='+vflink);
    }
    var delt = aelt.append('div').classed('vchoice', true).html('Only show v1');
    if(vf === '1') { delt.classed('vchoice-selected', true); }
  }

  // time choices for recommend/top/friends
  if(render_format === 'recommend' || render_format === 'top' || render_format === 'friends') {
    var elt = d3.select('#recommend-time-choice');
    elt.append('div').classed('fdivider', true).html('|');
    for(var i=0;i<time_ranges.length;i++) {
      var time_range = time_ranges[i];
      var aelt = elt.append('a').attr('href', '/'+link_endpoint+'?'+'timefilter='+time_range+'&vfilter='+vf);
      var delt = aelt.append('div').classed('timechoice', true).html(time_txt[time_range]);
      if(tf == time_range) { delt.classed('timechoice-selected', true); } // also render as chosen
    }
  }

  // time choices for top tweets
  if(render_format === 'toptwtr') {
    var tf = QueryString.timefilter; if(typeof tf === 'undefined') { tf = 'day'; } // default here is day
    var time_ranges = ['day', 'week', 'month'];
    var elt = d3.select('#recommend-time-choice');
    for(var i=0;i<time_ranges.length;i++) {
      var time_range = time_ranges[i];
      var aelt = elt.append('a').attr('href', '/'+link_endpoint+'?'+'timefilter='+time_range);
      var delt = aelt.append('div').classed('timechoice', true).html(time_txt[time_range]);
      if(tf == time_range) { delt.classed('timechoice-selected', true); } // also render as chosen
    }
  }

  var xb = $("#xbanner");
  if(xb.length !== 0) {
    xb.click(function(){ $("#banner").slideUp('fast'); })
  }

  // in top tab: color current choice
  if( render_format === 'recent') { d3.select('#tabrecent').classed('tab-selected', true); }
  if( render_format === 'top') { d3.select('#tabtop').classed('tab-selected', true); }
  if( render_format === 'toptwtr') { d3.select('#tabtwtr').classed('tab-selected', true); }
  if( render_format === 'friends') { d3.select('#tabfriends').classed('tab-selected', true); }
  if( render_format === 'discussions') { d3.select('#tabdiscussions').classed('tab-selected', true); }
  if( render_format === 'recommend') { d3.select('#tabrec').classed('tab-selected', true); }
  if( render_format === 'library') { d3.select('#tablib').classed('tab-selected', true); }

  $("#ingest-toggle").on('click', function(e) {
    e.preventDefault();
    $("#ingest-form").toggleClass('visible');
    if($("#ingest-form").hasClass('visible')) {
      $("#ingest-id").focus();
    }
  });

  $("#ingest-form").on('submit', function() {
    $("#ingest-toggle").prop('disabled', true);
    $("#ingest-form button[type='submit']").text('Adding...');
  });

  $("#goaway").on('click', function(){
    $("#prompt").slideUp('fast');
    $.post("/goaway", {}).done(function(data){ });
  });
});

</script>
</head>

<body>
<a href="https://github.com/karpathy/arxiv-sanity-preserver"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>

<div id="titdiv">
  <div class="header-bar">
    <!-- Left: title -->
    <a href="/">
      <div id="tittxt">
        <h1>Arxiv Sanity Preserver</h1>
        Built in spare time by <a href="https://twitter.com/karpathy">@karpathy</a> to accelerate research.<br>
        Serving last {{ totpapers }} papers from cs.[CV|CL|LG|AI|NE]/stat.ML
      </div>
    </a>

    <!-- Right: Arxiv Code bar + user info -->
    <div id="header-actions">
      <div class="header-actions-top">
        <div id="ingest-control">
          <button id="arxiv-code-btn" type="button">Arxiv Code</button>
          <button id="ingest-toggle" aria-label="Add arXiv paper" title="Add arXiv paper">+</button>

          <form id="ingest-form" method="post" action="{{ url_for('ingest_arxiv') }}">
            <input
              id="ingest-id"
              name="paper_id"
              type="text"
              placeholder="arXiv id (e.g., 1512.08756v2)"
              aria-label="arXiv identifier"
              required
            >
            <button type="submit">Add</button>
          </form>
        </div>

        <div id="userinfo">
          <a href="{{ url_for('account') }}">Single-user: {{ g.user.username }}</a>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="flashesdiv">
{% with flashes = get_flashed_messages() %}
    {% if flashes %}
      <ul class="flashes">
      {% for message in flashes %}
        <li>{{ message }}
      {% endfor %}
      </ul>
    {% endif %}
{% endwith %}
</div>

{% if render_format == "recent" and g.user.username is not defined %}
<div id="banner">
  <div style="float:right;cursor:pointer;" id="xbanner">X</div>
  New to arxiv-sanity? Check out the <a href="https://youtu.be/S2GY3gh6qC8" target="_blank">introduction video</a>.
</div>
{% endif %}

{% if show_prompt == "yes" %}
<div id="prompt" style="background-color:#f6ff7a; padding:10px; width:980px; margin-left:auto; margin-right:auto; font-size:14px;">
Hey there {{ g.user.username }}, sorry to interrupt. Arxiv-sanity costs a non-negligible amount of money to host.
If you love the site, please consider pitching in:
  <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" style="display:inline-block;">
  <input type="hidden" name="cmd" value="_s-xclick">
  <input type="hidden" name="hosted_button_id" value="DRW9PQ2J3U3RJ">
  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" style="display:inline-block;height:14px;">
  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
  </form>
To nuke this message away for a long time click <span id="goaway" style="text-decoration: underline;cursor: pointer;">here</span>.
</div>
{% endif %}

<div id="maindiv">
  <div id="content-grid">

    <!-- Left column: Research Conditions sidebar -->
    <aside id="search-menu">
      <div class="search-menu-title">Research Conditions</div>
      <form action="/search" method="get" id="search-menu-form">

        <label for="qfield">Search Bar</label>
        <input name="q" type="text" id="qfield" value="{{ search_query }}" placeholder="Find papers or authors">

        <label for="topic-select">Multi-Topics Selection</label>
        <div class="topic-scroll">
          <select id="topic-select" name="topics" size="10" multiple>
            <option value="" {% if not selected_topics %}selected{% endif %}>All topics</option>
            {% for topic in topics %}
              <option value="{{ topic.name }}" {% if topic.name in selected_topics %}selected{% endif %}>
                {{ topic.display_name }} ({{ topic.count }})
              </option>
            {% endfor %}
          </select>
        </div>

        <label for="min-score">Label Score &gt; X</label>
        <input name="min_score" id="min-score" type="number" step="0.1" min="0" value="{{ min_score }}" placeholder="e.g., 1.5">

        <!-- keep classification, just as an extra line -->
        <label for="classification-filter">Classification</label>
        <select id="classification-filter" name="classification">
          <option value="all" {% if selected_classification == 'all' %}selected{% endif %}>All classifications</option>
          <option value="hot" {% if selected_classification == 'hot' %}selected{% endif %}>Hot (score ≥ 2.0)</option>
          <option value="neutral" {% if selected_classification == 'neutral' %}selected{% endif %}>Neutral (1.0–2.0)</option>
          <option value="slop" {% if selected_classification == 'slop' %}selected{% endif %}>Slop (score &lt; 1.0)</option>
        </select>

        <button type="submit" class="primary-btn">Apply filters</button>
      </form>
    </aside>

    <!-- Right column: tabs + paper thread -->
    <section id="results-column">
      <div class="results-card">
        <div class="section-heading">Paper Feed</div>
        <div id="pagebar">
          <div class="pagelink" id="tabrecent"><a href="/">most recent</a></div>
          <div class="pagelink" id="tabtop"><a href="/top">top recent</a></div>
          <div class="pagelink" id="tabtwtr"><a href="/toptwtr">top hype</a></div>
          <div class="pagelink" id="tabfriends"><a href="/friends">friends</a></div>
          <div class="pagelink" id="tabdiscussions"><a href="/discussions">discussions</a></div>
          <div class="pagelink" id="tabrec"><a href="/recommend">recommended</a></div>
          <div class="pagelink" id="tablib"><a href="/library">library</a></div>
        </div>

        <div id="recommend-time-choice" class="centerdiv"></div>

        <div id="rtable"></div>

        <div id="loadmore">
          <button id="loadmorebtn">Load more</button>
        </div>
      </div>
    </section>

  </div>
</div>


<br><br><br><br><br><br>
</body>

</html>
